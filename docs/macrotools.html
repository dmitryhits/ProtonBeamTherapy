---

title: Tools to create macros for GATE simulations


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "nbs/00_macrotools.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_macrotools.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="MacroWriter-class">MacroWriter class<a class="anchor-link" href="#MacroWriter-class"> </a></h2><p>Main class for creating a macro file to be run by <a href="http://www.opengatecollaboration.org">Gate</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MacroWriter" class="doc_header"><code>class</code> <code>MacroWriter</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MacroWriter</code>(<strong><code>macro_folder</code></strong>=<em><code>'../mac'</code></em>, <strong><code>results_folder</code></strong>=<em><code>'../results'</code></em>, <strong><code>logs_folder</code></strong>=<em><code>'../logs'</code></em>, <strong><code>system_thickness</code></strong>=<em><code>1</code></em>, <strong><code>system_y_loc</code></strong>=<em><code>0</code></em>, <strong><code>sensor_material</code></strong>=<em><code>'Silicon'</code></em>, <strong><code>physics_list</code></strong>=<em><code>'QGSP_BERT_EMV'</code></em>)</p>
</blockquote>
<p>Main class for creating a macro file to be run by <code>gate</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MacroWriter.create_actors" class="doc_header"><code>MacroWriter.create_actors</code><a href="__main__.py#L186" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MacroWriter.create_actors</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MacroWriter.create_sensor" class="doc_header"><code>MacroWriter.create_sensor</code><a href="__main__.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MacroWriter.create_sensor</code>(<strong><code>n</code></strong>=<em><code>0</code></em>, <strong><code>x_length</code></strong>=<em><code>20</code></em>, <strong><code>z_length</code></strong>=<em><code>20</code></em>, <strong><code>thickness</code></strong>=<em><code>0.1</code></em>, <strong><code>x_loc</code></strong>=<em><code>0</code></em>, <strong><code>y_loc</code></strong>=<em><code>0</code></em>, <strong><code>z_loc</code></strong>=<em><code>0</code></em>, <strong><code>system</code></strong>=<em><code>'scanner'</code></em>)</p>
</blockquote>
<p>Compose a GATE macro for creating a sensor</p>
<p>In the current implementation snesor is a flat plane perpendicular to the beam 
which is by default in y direction
thickness dimension is in mm
all other dimensions are in cm</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MacroWriter.create_macro_file" class="doc_header"><code>MacroWriter.create_macro_file</code><a href="__main__.py#L278" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MacroWriter.create_macro_file</code>()</p>
</blockquote>
<p>creates the main macro file</p>
<p>output: name the macro file, a dictionary containing the list of root file
                            dictionary keys are 'trackers', 'hits', 'dose'</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MacroWriter.create_beam" class="doc_header"><code>MacroWriter.create_beam</code><a href="__main__.py#L211" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MacroWriter.create_beam</code>(<strong><code>energy</code></strong>=<em><code>250</code></em>, <strong><code>sigma_energy</code></strong>=<em><code>1.0</code></em>, <strong><code>position</code></strong>=<em><code>{'x': 0, 'y': 250, 'z': 0}</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-that-creates-the-full-system">Function that creates the full system<a class="anchor-link" href="#Function-that-creates-the-full-system"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_all" class="doc_header"><code>create_all</code><a href="https://github.com/dmitryhits/ProtonBeamTherapy/tree/master/ProtonBeamTherapy/macrotools.py#L338" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_all</code>(<strong><code>n_phantom_layers</code></strong>=<em><code>20</code></em>, <strong><code>phantom_layer_thickness</code></strong>=<em><code>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</code></em>, <strong><code>phantom_material</code></strong>=<em><code>'Water'</code></em>, <strong><code>beam_energy</code></strong>=<em><code>250</code></em>, <strong><code>distance_to_system</code></strong>=<em><code>1</code></em>, <strong><code>system_thickness</code></strong>=<em><code>1</code></em>, <strong><code>n_sensors</code></strong>=<em><code>1</code></em>, <strong><code>sensor_pitch</code></strong>=<em><code>0.5</code></em>, <strong><code>sensor_thickness</code></strong>=<em><code>0.5</code></em>)</p>
</blockquote>
<p>sets parameters for phantom and system geometries</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-to-run-the-created-macro">Function to run the created macro<a class="anchor-link" href="#Function-to-run-the-created-macro"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="run_macro" class="doc_header"><code>run_macro</code><a href="https://github.com/dmitryhits/ProtonBeamTherapy/tree/master/ProtonBeamTherapy/macrotools.py#L364" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>run_macro</code>(<strong><code>macroname</code></strong>, <strong><code>log_folder</code></strong>=<em><code>'../logs'</code></em>)</p>
</blockquote>
<p>runs macro file the log file is time stamped</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-small-function-to-recalculate-the-momentum-into-kinetic-energy">A small function to recalculate the momentum into kinetic energy<a class="anchor-link" href="#A-small-function-to-recalculate-the-momentum-into-kinetic-energy"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Ek" class="doc_header"><code>Ek</code><a href="__main__.py#L3" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Ek</code>(<strong><code>mass</code></strong>, <strong><code>momentum</code></strong>)</p>
</blockquote>
<p>Helpfull function that converts momentum to kinetic energy</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-that-creates-and-runs-macro-for-the-full-system">Example that creates and runs macro for the full system<a class="anchor-link" href="#Example-that-creates-and-runs-macro-for-the-full-system"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export-notebooks">Export notebooks<a class="anchor-link" href="#Export-notebooks"> </a></h2>
</div>
</div>
</div>
</div>
 

